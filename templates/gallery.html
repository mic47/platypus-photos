<div>
  {% if input.page > 0 %}<a href="#" class="prev-url">Prev Page</a>{% else %}Prev Page{% endif %}
  {% if has_next_page %}<a href="#" class="next-url">Next Page</a>{% else %}Next Page{% endif %}
</div>
{% for image in images %}
  {% if loop.index0 == oi %}
  <div class="gallery_item overlay">
  {% else %}
  <div class="gallery_item">
  {% endif %}
    <span id="i{{loop.index0}}"></span>
    <div class="gallery_item_fs">
        {% if loop.index0 == 0 %}
        {% if input.page > 0 %}<a onclick="prev_page()" href="#}">prev</a>{% else %} prev {% endif %}
        {% else %}
        <a href="#i{{ loop.index0}}" onclick="overlay_prev(this, {{ loop.index0 }})">prev</a>
        {% endif %}
        <a href="#i{{ loop.index0}}" onclick="overlay_close(this)">close</a>
        {% if loop.index == images|length %}
        {% if has_next_page %}<a onclick="next_page()" href="#">next</a>{% else %} next {% endif %}
        {% else %}
        <a href="#i{{ loop.index0}}" onclick="overlay_next(this, {{ loop.index0 }})">next</a>
        {% endif %}
    </div>
    {% if image.timeicon %}
        {% if ascending %}
        <a href="#" onclick='update_url({"tsto":{{image.timestamp}}+0.01})'>‚¨ÖÔ∏è to</a>
        {% else %}
        <a href="#" onclick='update_url({"tsfrom":{{image.timestamp}}-0.01})'>‚¨ÖÔ∏è from</a>
        {% endif %}
        {{image.timeicon}}
        {% if image.being_annotated %}üèóÔ∏è{% endif %}
        {% if ascending %}
        <a href="#" onclick='update_url({"tsfrom":{{image.timestamp}}-0.01})'>from ‚û°Ô∏è</a>
        {% else %}
        <a href="#" onclick='update_url({"tsto":{{image.timestamp}}+0.01})'>to ‚û°Ô∏è</a>
        {% endif %}
    {% else %}
        {% if image.being_annotated %}üèóÔ∏è{% endif %}
    {% endif %}
    {% if image.diff_date%}
        {% if image.timeicon %}<br/>{% endif %}
        ‚è±Ô∏è{{image.diff_date}}
    {% endif %}
    <div class="gallery_container" onclick="overlay(this, {{ loop.index0 }})">
        <img loading="lazy" src="/img?hsh={{image.hsh}}&size={% if loop.index0 == oi %}original{%else%}preview{%endif%}" class="gallery_image" alt="{{image.classifications}}" title="{{image.classifications}}"/>
    </div>
    <div class="overflow">
      {% if image.date %}
        <span class="date"><a onclick='update_url({"tsfrom": "{{image.date_timestamp_start}}", "tsto": "{{image.date_timestamp_end}}"})' href="#">{{image.date}}</a></span>
      {% endif %}
      {% if image.time%}
        <span class="date">{{image.time}}</span>
      {% endif %}
      {% for address in image.addrs %}
        <span class="location"><a onclick='update_url({"addr": "{{address|safe}}"})' href="#">{{ address | append_flag }}</a></span>
      {% endfor %}
      {% for tag in image.tags %}
        {%if not tag[1] %}<span class="tag"><a onclick='update_url_add_tag("{{tag[0]|safe}}")' href="#">{{tag[1]}}{{tag[0]}}</a></span>{% endif %}
      {% endfor %}
      {% if image.camera %}<span class="camera">{{image.camera}}</span>{% endif %}
      <div class="gallery_item_fs overflow">
        {% if image.software %}<span class="camera">{{image.software}}</span>{% endif %}
        {% for tag in image.tags %}
          {%if tag[1] %}<span class="tag"><a onclick='update_url_add_tag("{{tag[0]|safe}}")' href="#">{{tag[1]}}{{tag[0]}}</a></span>{% endif %}
        {% endfor %}
        {% for path in image.paths %}
          <span class="dir"><a onclick='update_dir("{{path.dir|safe}}")' href="#">{{path.dir}}</a></span>
        {% endfor %}
        {% for raw in image.raw_data %}
          <span class="raw">{{ raw.k }}: {{raw.v}}</span>
        {% endfor %}
      </div>
    </div>
  </div>
{% endfor %}
</div>
<br>
<div style="float: left; background: #CCCCCC; height: 10em;">
  {% if input.page > 0 %}<a href="#" class="prev-url">Prev Page</a>{% else %}Prev Page{% endif %}
  {% if has_next_page %}<a href="#" class="next-url">Next Page</a>{% else %}Next Page{% endif %}
</div>
